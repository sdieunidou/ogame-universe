{% extends 'base.html.twig' %}

{% block title %}[{{ galaxy }}:{{ system }}] - Galaxy{% endblock %}

{% macro pagination(galaxy, system) %}
    <div class="btn-group">
        <a class="btn btn-dark btn-sm" href="{{ path('app_cartography', {galaxy: galaxy, system: universe_system(system - 1)}) }}"><<</a>
        <a class="btn btn-dark btn-sm" href="{{ path('app_cartography', {galaxy: galaxy, system: universe_system(system + 1)}) }}">>></a>
    </div>
{% endmacro %}

{%- macro playerStatus(status) -%}
    player-status-{{ status }}
{%- endmacro -%}

{%- macro playerStatusColor(status) -%}
    player-status-{{ status }}
{%- endmacro -%}

{% block body %}
    <div class="d-flex justify-content-cente mt-5 mb-1 form-coordinates">
        {{ form_start(form, {
            attr: {
                class: 'form-inline'
            }
        }) }}

            {{ _self.pagination(galaxy, system) }}

            <div class="form-group">
                {{ form_widget(form.galaxy, {
                    attr: {
                        class: 'form-control-sm mr-1 ml-2'
                    }
                }) }}

                {{ form_widget(form.system, {
                    attr: {
                        class: 'form-control-sm'
                    }
                }) }}
            </div>

            <button type="submit" class="btn btn-primary btn-sm ml-1 mr-1">GO</button>
        {{ form_end(form) }}
    </div>

    <table class="table table-striped table-sm table-dark  table-hover">
        <caption>
            {{ _self.pagination(galaxy, system) }}
        </caption>
        <tbody>
            {% for planet in planets %}
                <tr>
                    {% if planet.position is defined %}
                        <th>
                            [{{ galaxy }}:{{ system }}:{{ loop.index }}]
                        </th>
                        <td>{{ planet.name }}</td>
                        <td>
                            <span class="{{ _self.playerStatusColor(planet.player.status) }}">
                                {{ planet.player.name }}

                                {% if not planet.player.isActive %}
                                    <small>({{ planet.player.status }})</small>
                                {% endif %}
                            </span>

                            {% if planet.player.scorePosition > 0 %}
                                <small>#{{ planet.player.scorePosition }}</small>
                            {% endif %}
                        </td>
                        <td>{{ planet.hasMoon ? 'Moon' : '' }}</td>
                    {% else %}
                        <th>
                            [{{ galaxy }}:{{ system }}:{{ loop.index }}]
                        </th>
                        <td colspan="3"></td>
                    {% endif %}
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="d-flex justify-content-center">
    </div>
{% endblock %}
